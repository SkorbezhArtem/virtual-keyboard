(()=>{"use strict";(()=>{function e(e,i){if(e){if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,i):void 0}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(i){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=document.createElement(i);r&&(n=a.classList).add.apply(n,function(e){if(Array.isArray(e))return t(e)}(o=r.split(" "))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||e(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),Array.isArray(c)?c.forEach((function(e){"string"==typeof e?a.appendChild(document.createTextNode(e)):e instanceof Node&&a.append(e)})):"string"==typeof c?a.innerHTML=c:c instanceof Node&&a.append(c),s instanceof Node&&s.append(a);for(var y=arguments.length,l=new Array(y>4?y-4:0),f=4;f<y;f++)l[f-4]=arguments[f];return l.forEach((function(t){var i=function(t,i){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,o,r,c,s=[],a=!0,y=!1;try{if(r=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;a=!1}else for(;!(a=(n=r.call(i)).done)&&(s.push(n.value),s.length!==t);a=!0);}catch(e){y=!0,o=e}finally{try{if(!a&&null!=i.return&&(c=i.return(),Object(c)!==c))return}finally{if(y)throw o}}return s}}(t,i)||e(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=i[0],o=i[1];""===o?a.setAttribute(n,""):["id","value","cols","placeholder","rows","autocorrect","spellcheck"].includes(n)?a.setAttribute(n,o):a.dataset[n]=o})),a}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,r=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(r)?r:String(r)),o)}var r}const r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storage=window.localStorage}var t,i;return t=e,i=[{key:"set",value:function(e,t){this.storage.setItem(e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.storage.getItem(e)||t}},{key:"del",value:function(e){this.storage.removeItem(e)}}],i&&o(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}());function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==c(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===c(o)?o:String(o)),n)}var o}function a(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var y=a((function e(t){var n=t.key,o=t.shift,r=t.code;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=n,this.shift=o,this.code=r,this.isFnKey=Boolean(n.match(/Tab|Caps|Shift|Ctrl|Alt|Enter|Back|Del|arr|En|Ru/)),this.keyShift=i("div","key-shift",o&&o.match(/[^0-9a-zA-Zа-яА-ЯёЁ]/)?o:""),this.keyTitle=i("div","key-title",n),this.keyContainer=i("div","keyboard__key",[this.keyShift,this.keyTitle],null,["code",this.code],["fn",String(this.isFnKey)])}));const l={ru:[{key:"ё",shift:"Ё",code:"Backquote"},{key:"1",shift:"!",code:"Digit1"},{key:"2",shift:'"',code:"Digit2"},{key:"3",shift:"№",code:"Digit3"},{key:"4",shift:";",code:"Digit4"},{key:"5",shift:"%",code:"Digit5"},{key:"6",shift:":",code:"Digit6"},{key:"7",shift:"?",code:"Digit7"},{key:"8",shift:"*",code:"Digit8"},{key:"9",shift:"(",code:"Digit9"},{key:"0",shift:")",code:"Digit0"},{key:"-",shift:"_",code:"Minus"},{key:"=",shift:"+",code:"Equal"},{key:"Backspace",shift:null,code:"Backspace"},{key:"Delete",shift:null,code:"Delete"},{key:"Tab",shift:null,code:"Tab"},{key:"й",shift:"Й",code:"KeyQ"},{key:"ц",shift:"Ц",code:"KeyW"},{key:"у",shift:"У",code:"KeyE"},{key:"к",shift:"К",code:"KeyR"},{key:"е",shift:"Е",code:"KeyT"},{key:"н",shift:"Н",code:"KeyY"},{key:"г",shift:"Г",code:"KeyU"},{key:"ш",shift:"Ш",code:"KeyI"},{key:"щ",shift:"Щ",code:"KeyO"},{key:"з",shift:"З",code:"KeyP"},{key:"х",shift:"Х",code:"BracketLeft"},{key:"ъ",shift:"Ъ",code:"BracketRight"},{key:"Enter",shift:null,code:"Enter"},{key:"CapsLock",shift:null,code:"CapsLock"},{key:"ф",shift:"Ф",code:"KeyA"},{key:"ы",shift:"Ы",code:"KeyS"},{key:"в",shift:"В",code:"KeyD"},{key:"а",shift:"А",code:"KeyF"},{key:"п",shift:"П",code:"KeyG"},{key:"р",shift:"Р",code:"KeyH"},{key:"о",shift:"О",code:"KeyJ"},{key:"л",shift:"Л",code:"KeyK"},{key:"д",shift:"Д",code:"KeyL"},{key:"ж",shift:"Ж",code:"Semicolon"},{key:"э",shift:"Э",code:"Quote"},{key:"\\",shift:"/",code:"Backslash"},{key:"Shift",shift:null,code:"ShiftLeft"},{key:"я",shift:"Я",code:"KeyZ"},{key:"ч",shift:"Ч",code:"KeyX"},{key:"с",shift:"С",code:"KeyC"},{key:"м",shift:"М",code:"KeyV"},{key:"и",shift:"И",code:"KeyB"},{key:"т",shift:"Т",code:"KeyN"},{key:"ь",shift:"Ь",code:"KeyM"},{key:"б",shift:"Б",code:"Comma"},{key:"ю",shift:"Ю",code:"Period"},{key:".",shift:",",code:"Slash"},{key:"Shift",shift:null,code:"ShiftRight"},{key:"Ctrl",shift:null,code:"ControlLeft"},{key:"Alt",shift:null,code:"AltLeft"},{key:" ",shift:null,code:"Space"},{key:"Alt",shift:null,code:"AltRight"},{key:"Ctrl",shift:null,code:"ControlRight"},{key:"&larr;",shift:null,code:"ArrowLeft"},{key:"&uarr;",shift:null,code:"ArrowUp"},{key:"&darr;",shift:null,code:"ArrowDown"},{key:"&rarr;",shift:null,code:"ArrowRight"},{key:"Ru",shift:null,code:"Lang"}],en:[{key:"`",shift:"~",code:"Backquote"},{key:"1",shift:"!",code:"Digit1"},{key:"2",shift:"@",code:"Digit2"},{key:"3",shift:"#",code:"Digit3"},{key:"4",shift:"$",code:"Digit4"},{key:"5",shift:"%",code:"Digit5"},{key:"6",shift:"^",code:"Digit6"},{key:"7",shift:"&",code:"Digit7"},{key:"8",shift:"*",code:"Digit8"},{key:"9",shift:"(",code:"Digit9"},{key:"0",shift:")",code:"Digit0"},{key:"-",shift:"_",code:"Minus"},{key:"=",shift:"+",code:"Equal"},{key:"Backspace",shift:null,code:"Backspace"},{key:"Delete",shift:null,code:"Delete"},{key:"Tab",shift:null,code:"Tab"},{key:"q",shift:"Q",code:"KeyQ"},{key:"w",shift:"W",code:"KeyW"},{key:"e",shift:"E",code:"KeyE"},{key:"r",shift:"R",code:"KeyR"},{key:"t",shift:"T",code:"KeyT"},{key:"y",shift:"Y",code:"KeyY"},{key:"u",shift:"U",code:"KeyU"},{key:"i",shift:"I",code:"KeyI"},{key:"o",shift:"O",code:"KeyO"},{key:"p",shift:"P",code:"KeyP"},{key:"[",shift:"{",code:"BracketLeft"},{key:"]",shift:"}",code:"BracketRight"},{key:"Enter",shift:null,code:"Enter"},{key:"CapsLock",shift:null,code:"CapsLock"},{key:"a",shift:"A",code:"KeyA"},{key:"s",shift:"S",code:"KeyS"},{key:"d",shift:"D",code:"KeyD"},{key:"f",shift:"F",code:"KeyF"},{key:"g",shift:"G",code:"KeyG"},{key:"h",shift:"H",code:"KeyH"},{key:"j",shift:"J",code:"KeyJ"},{key:"k",shift:"K",code:"KeyK"},{key:"l",shift:"L",code:"KeyL"},{key:";",shift:":",code:"Semicolon"},{key:"'",shift:'"',code:"Quote"},{key:"\\",shift:"|",code:"Backslash"},{key:"Shift",shift:null,code:"ShiftLeft"},{key:"z",shift:"Z",code:"KeyZ"},{key:"x",shift:"X",code:"KeyX"},{key:"c",shift:"C",code:"KeyC"},{key:"v",shift:"V",code:"KeyV"},{key:"b",shift:"B",code:"KeyB"},{key:"n",shift:"N",code:"KeyN"},{key:"m",shift:"M",code:"KeyM"},{key:",",shift:"<",code:"Comma"},{key:".",shift:">",code:"Period"},{key:"/",shift:"?",code:"Slash"},{key:"Shift",shift:null,code:"ShiftRight"},{key:"Ctrl",shift:null,code:"ControlLeft"},{key:"Alt",shift:null,code:"AltLeft"},{key:" ",shift:null,code:"Space"},{key:"Alt",shift:null,code:"AltRight"},{key:"Ctrl",shift:null,code:"ControlRight"},{key:"&larr;",shift:null,code:"ArrowLeft"},{key:"&uarr;",shift:null,code:"ArrowUp"},{key:"&darr;",shift:null,code:"ArrowDown"},{key:"&rarr;",shift:null,code:"ArrowRight"},{key:"En",shift:null,code:"Lang"}]};function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function u(e,t,i){return(t=d(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}var k=i("div","container",[i("h1","title","Virtual Keyboard"),i("p","subtitle","The keyboard was created in the Windows OS"),i("p","subtitle","Press Ctrl + Alt to change language")]),p=i("textarea","textarea",null,k,["placeholder","Start type something..."]),v=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"preHandleEvent",(function(e){e.stopPropagation();var t=e.target.closest(".keyboard__key");if(t){var n=t.dataset.code;t.addEventListener("mouseleave",i.resetButtonState),i.handleEvent({code:n,type:e.type})}})),u(this,"resetButtonState",(function(e){var t=e.target.dataset.code,n=i.keyButtons.find((function(e){return e.code===t}));i.isCaps||n.keyContainer.classList.remove("active"),n.keyContainer.removeEventListener("mouseleave",i.resetButtonState)})),u(this,"handleEvent",(function(e){e.stopPropagation&&e.stopPropagation();var t=e.code,n=e.type,o=i.keyButtons.find((function(e){return e.code===t}));if(o)if(i.textarea.focus(),n.match(/keydown|mousedown/)){if(n.includes("key")&&e.preventDefault(),o.keyContainer.classList.add("active"),t.includes("Shift")&&(i.shiftKey=!0),i.shiftKey&&i.switchToUpperCase(!0),t.includes("Caps")&&!i.isCaps?(i.isCaps=!0,i.switchToUpperCase(!0)):t.includes("Caps")&&i.isCaps&&(i.isCaps=!1,i.switchToUpperCase(!1),o.keyContainer.classList.remove("active")),["Control","Alt","Caps"].includes(t)&&e.repeat)return;t.includes("Control")&&(i.ctrlKey=!0),t.includes("Alt")&&(i.altKey=!0),t.includes("ControlLeft")&&i.altKey&&i.changeLang(),t.includes("AltLeft")&&i.ctrlKey&&i.changeLang(),t.includes("ControlRight")&&i.altKey&&i.changeLang(),t.includes("AltRight")&&i.ctrlKey&&i.changeLang(),i.isCaps?i.printToTextarea(o,i.shiftKey?o.keyShift.innerHTML||o.shift:o.key):i.printToTextarea(o,i.shiftKey?o.shift:o.key)}else n.match(/keyup|mouseup/)&&(t.includes("Shift")&&(i.shiftKey=!1,i.switchToUpperCase(!1)),t.includes("Control")&&(i.ctrlKey=!1),t.includes("Alt")&&(i.altKey=!1),t.includes("Caps")||o.keyContainer.classList.remove("active"))})),u(this,"changeLang",(function(){var e=Object.keys(l),t=e.indexOf(i.container.dataset.lang);i.keyBase=t+1<e.length?l[e[t+=1]]:l[e[t=0]],i.container.dataset.lang=e[t],r.set("lang",e[t]),i.keyButtons.forEach((function(e){var t=e,n=i.keyBase.find((function(t){return t.code===e.code}));n&&(t.shift=n.shift,t.key=n.key,n.shift&&n.shift.match(/[^0-9a-zA-Zа-яА-ЯёЁ]/)?t.keyShift.innerHTML=n.shift:t.keyShift.innerHTML="",t.keyTitle.innerHTML=n.key)})),i.isCaps&&i.switchToUpperCase(!0)})),this.keyboardRows=t,this.isCaps=!1}var t,n;return t=e,(n=[{key:"init",value:function(e){return this.keyBase=l[e],this.textarea=p,this.container=i("div","keyboard",null,k,["lang",e]),document.body.prepend(k),this.renderLayout(),this}},{key:"renderLayout",value:function(){var e=this;this.keyButtons=[],this.keyboardRows.forEach((function(t,n){var o=i("div","keyboard__row",null,e.container,["row",n+1]);t.forEach((function(t){var i=e.keyBase.find((function(e){return e.code===t}));if(i){var n=new y(i);e.keyButtons.push(n),o.append(n.keyContainer)}}))})),document.addEventListener("keydown",this.handleEvent),document.addEventListener("keyup",this.handleEvent),this.container.addEventListener("mousedown",this.preHandleEvent),this.container.addEventListener("mouseup",this.preHandleEvent)}},{key:"switchToUpperCase",value:function(e){var t=this;e?this.keyButtons.forEach((function(e){var i=e;i.keyShift&&t.shiftKey&&(i.keyShift.classList.add("key-shift_active"),i.keyTitle.classList.add("key-shift_inactive")),i.isFnKey||!t.isCaps||t.shiftKey||i.keyShift.innerHTML?!i.isFnKey&&t.isCaps&&t.shiftKey?i.keyTitle.innerHTML=i.key:i.isFnKey||i.keyShift.innerHTML||(i.keyTitle.innerHTML=i.shift):i.keyTitle.innerHTML=i.shift})):this.keyButtons.forEach((function(e){var i=e;i.keyShift.innerHTML&&!i.isFnKey?(i.keyShift.classList.remove("key-shift_active"),i.keyTitle.classList.remove("key-shift_inactive"),t.isCaps||(i.keyTitle.innerHTML=i.key)):i.isFnKey||(t.isCaps?i.keyTitle.innerHTML=i.shift:i.keyTitle.innerHTML=i.key)}))}},{key:"printToTextarea",value:function(e,t){var i=this,n=this.textarea.selectionStart,o=this.textarea.value.slice(0,n),r=this.textarea.value.slice(n),c=this.textarea.selectionEnd-this.textarea.selectionStart,s={Tab:function(){i.insertText("".concat(o,"\t").concat(r.slice(c)),n+1)},ArrowLeft:function(){i.insertText("".concat(o,"⇐").concat(r.slice(c)),n+1)},ArrowRight:function(){i.insertText("".concat(o,"⇒").concat(r.slice(c)),n+1)},ArrowUp:function(){i.insertText("".concat(o,"⇑").concat(r.slice(c)),n+1)},ArrowDown:function(){i.insertText("".concat(o,"⇓").concat(r.slice(c)),n+1)},Enter:function(){i.insertText("".concat(o,"\n").concat(r.slice(c)),n+1)},Delete:function(){c>0?i.insertText("".concat(o).concat(r.slice(c)),n):i.insertText("".concat(o).concat(r.slice(1)),n)},Backspace:function(){c>0?i.insertText("".concat(o).concat(r.slice(c)),n):i.insertText("".concat(o.slice(0,-1)).concat(r),n-1)},Space:function(){i.insertText("".concat(o," ").concat(r.slice(c)),n+1)},Lang:function(){i.changeLang()}};s[e.code]?s[e.code]():e.isFnKey||this.insertText("".concat(o).concat(t||"").concat(r.slice(c)),n+1)}},{key:"insertText",value:function(e,t){this.textarea.value=e,this.textarea.setSelectionRange(t,t)}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),g=r.get("lang","en");new v([["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","IntlBackslash","Backslash","Delete"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight"],["ControlLeft","Lang","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"]]).init(g)})()})();